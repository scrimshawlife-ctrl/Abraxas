{% extends "base.html" %}
{% block content %}
<h1>Stability Report</h1>
<p><a href="/runs/{{ run.run_id }}">Back to run</a></p>

<div class="card">
  <h2>Summary</h2>
  <p><b>Passed:</b> {{ report.invariance.passed }}</p>
  <p><b>Distinct hashes:</b> {{ report.invariance.distinct_final_hashes }}</p>
  <p><b>Leader hash:</b> {{ report.invariance.leader_hash[:12] }}</p>
  <p><b>Drift class:</b> {{ report.drift_class }}</p>
</div>

{% if report.invariance.mismatched_cycles %}
  <div class="card" style="margin-top:12px;">
    <h2>Mismatched cycles</h2>
    <p>{{ report.invariance.mismatched_cycles }}</p>
  </div>
{% endif %}

<div class="card" style="margin-top:12px;">
  <h2>Cycles</h2>
  <table>
    <tr><th align="left">cycle</th><th align="left">final hash</th><th align="left">extract</th><th align="left">compress</th><th align="left">propose</th></tr>
    {% for entry in report.results %}
      <tr>
        <td>{{ entry.cycle }}</td>
        <td><code>{{ entry.final_hash[:12] }}</code></td>
        <td><code>{{ entry.operator_hashes.extract_structure_v0[:10] }}</code></td>
        <td><code>{{ entry.operator_hashes.compress_signal_v0[:10] }}</code></td>
        <td><code>{{ entry.operator_hashes.propose_actions_v0[:10] }}</code></td>
      </tr>
    {% endfor %}
  </table>
</div>
{% endblock %}
